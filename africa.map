<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>MİLİTAN ATLASI - AFRİKA</title>
  <style>
    /* İngilizce versiyondaki stil + Türkçe versiyondaki küçük farklar birleştirildi (temiz hali) */
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: #111;
      color: #eee;
      height: 100vh;
      overflow: hidden;
      touch-action: none;
    }
    #container { display: flex; height: 100%; }
    #map-area {
      flex: 1;
      position: relative;
      background: #1a1a1a;
      overflow: hidden;
      touch-action: none;
      cursor: grab;
    }
    svg {
      width: 100%;
      height: 100%;
      display: block;
      user-select: none;
      touch-action: none;
    }
    svg path {
      fill: #ffffff;
      stroke: #333;
      stroke-width: 0.7;
      transition: fill 0.3s ease, stroke 0.3s ease;
      pointer-events: all;
    }
    svg path:hover, svg path:focus { fill: #4ade80; outline: none; }
    svg path:focus-visible { outline: 3px solid #4ade80; outline-offset: 2px; }
    svg path.active { fill: #ff4444 !important; stroke: #fff; stroke-width: 1.8; }
    .tooltip {
      position: absolute;
      background: rgba(0,0,0,0.88);
      color: white;
      padding: 8px 14px;
      border-radius: 6px;
      font-size: 13px;
      pointer-events: none;
      display: none;
      z-index: 100;
      max-width: 260px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.6);
      opacity: 0;
      transition: opacity 0.18s ease;
    }
    .tooltip.visible { opacity: 1; }
    .tooltip strong { display: block; font-size: 15px; margin-bottom: 5px; }
    #sidebar {
      width: 320px;
      background: #1f1f1f;
      border-left: 1px solid #333;
      color: #ddd;
      padding: 20px;
      position: relative;
      overflow-y: auto;
      display: none;
      transition: transform 0.3s ease;
      transform: translateX(100%);
      touch-action: auto;
    }
    #sidebar.active { display: block; transform: translateX(0); }
    #sidebar-close {
      position: absolute;
      top: 12px; right: 12px;
      width: 36px; height: 36px;
      background: #444;
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 24px;
      line-height: 34px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    #sidebar-close:hover { background: #666; transform: scale(1.08); }
    #search-container { margin-bottom: 18px; }
    #search-input {
      width: 100%;
      padding: 10px 12px;
      background: #2a2a2a;
      border: 1px solid #444;
      color: white;
      border-radius: 6px;
      font-size: 15px;
    }
    #search-input::placeholder { color: #888; }
    .group {
      margin: 14px 0;
      padding: 10px;
      background: #2a2a2a;
      border-radius: 6px;
    }
    .group a {
      color: #4ade80;
      text-decoration: none;
      font-size: 14.5px;
    }
    .group a:hover { text-decoration: underline; }
    #search-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 70px;
      height: 70px;
      background: #4ade80;
      color: #111;
      border: none;
      border-radius: 50%;
      font-size: 11px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.6);
      z-index: 150;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 6px;
      line-height: 1.15;
      transition: all 0.3s ease;
    }
    #search-button:hover { background: #27ae60; transform: scale(1.1); }
    #search-button.hidden { opacity: 0; pointer-events: none; transform: scale(0.7); }
    @media (max-width: 768px) {
      #container { flex-direction: column; }
      #map-area { flex: 1 1 60%; }
      #sidebar {
        width: 100%;
        height: auto;
        max-height: 60%;
        min-height: 40%;
        position: fixed;
        bottom: 0; left: 0; right: 0;
        transform: translateY(100%);
        border-left: none;
        border-top: 1px solid #444;
        background: #1f1f1f;
        z-index: 200;
        overflow-y: auto;
        touch-action: pan-y pinch-zoom;
      }
      #sidebar.active { transform: translateY(0); }
      #sidebar-close { top: 12px; right: 12px; z-index: 201; }
      #sidebar-content { padding-bottom: 60px; }
      #search-button { bottom: 90px; }
    }
  </style>
</head>
<body>
<div id="container">
  <div id="map-area">
    <svg id="svg-map" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
      <!-- SVG path'ler aynı kaldı (ikisinde de aynı) -->
      <path id="AO" data-name="Angola" data-id="AO" d="m 495.3,598.6 -36,-0.2 -4.3,1.7 -3.5,-0.3 -5.1,1.9 -1.1,2.7 6,8.7 2.4,9.3 3.6,13.4 -3.8,5.5 -0.6,2.8 2.9,8.3 3.1,8.4 3.6,5 0.6,7.8 -1.4,10.3 -4,6.1 -7.1,9.1 -2.9,5.6 -4.1,12.5 -0.8,5.9 -4.3,12.7 -1.9,12.2 1,8.7 5.9,-2.7 7.2,-2.3 7.8,0.4 7.1,6.3 1.9,-1 48.8,-0.6 8.2,6.6 29.1,2 22.4,-5.7 -7.6,-8.6 -7.8,-11.3 1.6,-44 25.3,0.1 -1,-4.7 2,-5.2 -2,-6.5 1.5,-6.7 -1.2,-4.3 -5.5,-0.8 -7.6,2 -5.3,-0.3 -3,1.3 0.9,-16.5 -3.9,-5.1 -0.8,-8.5 1.9,-8.4 -2.4,-5.3 -0.1,-8.7 -14.8,0.1 1.1,-5 -6.2,0.1 -0.7,2.4 -7.6,0.5 -3.1,8.1 -1.9,3.4 -6.7,-1.9 -4,1.9 -8.1,1.1 -4.6,-7.2 -2.7,-4.5 -3.5,-8.3 -2.9,-10.3 z m -47.4,-2.7 0.4,-6 2,-3.5 4.5,-2.9 -4.6,-4.8 -3.7,2.3 -5,6 3.3,10.4 3.1,-1.5 z" />
      <!-- ... diğer tüm path'ler aynı şekilde devam eder (ikisinde de aynı oldukları için kopyala-yapıştır yaptım) -->
      <!-- Not: Tüm path'leri buraya koymadım çünkü çok uzun, senin kodundan kopyala -->
    </svg>
    <div class="tooltip" id="tooltip"></div>
  </div>
  <div id="sidebar">
    <button id="sidebar-close">×</button>
    <div id="search-container">
      <input type="text" id="search-input" placeholder="">
    </div>
    <div id="sidebar-content"></div>
  </div>
</div>
<button id="search-button"></button>

<script>
// Dil verileri (sadece haritaya özel değişen metinler)
const translations = {
  tr: {
    title: "MİLİTAN ATLASI - AFRİKA",
    searchPlaceholder: "ARAMA YAP...",
    searchButton: "ARAMA YAP",
    noGroups: "Bu bölge için grup bilgisi bulunmuyor.",
    dataError: "Veri dosyası yüklenemedi.",
    tooltipGroups: "Gruplar:"
  },
  en: {
    title: "MILITANT ATLAS - AFRICA",
    searchPlaceholder: "Search...",
    searchButton: "SEARCH",
    noGroups: "No group information for this region.",
    dataError: "Data file could not be loaded.",
    tooltipGroups: "Groups:"
  }
};

// Sayfa yüklendiğinde dil uygula
window.addEventListener('load', () => {
  const lang = localStorage.getItem('lang') || 'tr';
  const t = translations[lang];

  // Başlık
  document.title = t.title;

  // Arama placeholder
  document.getElementById('search-input').placeholder = t.searchPlaceholder;

  // Arama butonu metni
  document.getElementById('search-button').textContent = t.searchButton;

  // Dil bazlı tooltip/sidebar için yardımcı fonksiyon
  window.getTranslation = key => t[key] || key;
});

// Veri yükleme ve harita başlatma (mevcut kodun aynısı)
fetch("data.json")
  .then(res => res.json())
  .then(data => {
    countryData = data;
    initMap();
  })
  .catch(err => {
    console.error("data.json yüklenemedi:", err);
    document.getElementById('sidebar-content').innerHTML = `<p style="color:#ff4444;">${getTranslation('dataError')}</p>`;
    initMap(); // veri olmasa da harita etkileşimleri çalışsın
  });

function initMap() {
  const lang = localStorage.getItem('lang') || 'tr';
  const t = translations[lang];

  const paths = document.querySelectorAll("svg path");
  paths.forEach(path => {
    const id = path.id;
    const fallbackName = path.getAttribute("data-name") || id || "Unknown";
    const country = countryData[id] || {};

    // Hover / Tooltip
    const enterHandler = (e) => {
      if (e.touches && e.touches.length > 1) return;
      const name = country.name || fallbackName;
      const groupsText = country.groups?.length
        ? country.groups.map(g => g.name || g).join("<br>")
        : getTranslation('noGroups');
      tooltip.innerHTML = `<strong>${name}</strong><br>${groupsText}`;
      tooltip.style.display = "block";
      tooltip.classList.add("visible");
      moveTooltip(e);
    };

    path.addEventListener("mouseenter", enterHandler);
    path.addEventListener("touchstart", enterHandler, { passive: true });
    path.addEventListener("mousemove", moveTooltip);
    path.addEventListener("touchmove", moveTooltip, { passive: true });

    // Tıklama
    path.addEventListener("click", () => {
      if (activePath) activePath.classList.remove("active");
      path.classList.add("active");
      activePath = path;
      showSidebar(id, fallbackName);
    });

    path.addEventListener("touchend", (e) => {
      if (e.touches.length === 0) path.dispatchEvent(new Event("click"));
    }, { passive: true });
  });

  mapArea.addEventListener("mouseleave", hideTooltip);
  mapArea.addEventListener("touchend", (e) => {
    if (e.touches.length === 0) hideTooltip();
  }, { passive: true });
}

// Sidebar gösterme (dil destekli)
function showSidebar(id, fallbackName) {
  const lang = localStorage.getItem('lang') || 'tr';
  const t = translations[lang];
  const data = countryData[id] || {};
  const name = data.name || fallbackName;

  let html = `<h2 style="margin-top:0;">${name}</h2>`;
  if (Object.keys(countryData).length === 0) {
    html += `<p style="color:#ff4444; font-weight:bold;">${t.dataError}</p>`;
  } else if (data.groups && data.groups.length > 0) {
    data.groups.forEach(group => {
      html += `
        <div class="group">
          <a href="${group.url || '#'}" target="_blank" rel="noopener noreferrer">
            ${group.name}
          </a>
        </div>
      `;
    });
  } else {
    html += `<p>${t.noGroups}</p>`;
  }
  document.getElementById("sidebar-content").innerHTML = html;
  document.getElementById("sidebar").classList.add("active");
  document.getElementById("sidebar-content").scrollTop = 0;
}

// Diğer mevcut fonksiyonlar (moveTooltip, hideTooltip, closeSidebar, arama filtreleme vs.) aynı kalır
// Senin kodundan kopyala-yapıştır yapabilirsin – sadece yukarıdaki kısımları değiştir

// Arama butonu açma (dil butonu zaten index'te var, burada gerek yok)
document.getElementById("search-button").addEventListener("click", () => {
  document.getElementById("sidebar").classList.add("active");
  document.getElementById("search-button").classList.add("hidden");
});
</script>
</body>
</html>
